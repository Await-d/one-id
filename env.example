# ============================================================
# OneID 环境变量配置示例
# ============================================================
#
# 用途: 提供部署时的环境变量配置模板
# 使用方法:
#   1. 复制此文件为 .env: cp env.example .env
#   2. 修改配置值
#   3. 使用 docker-compose 启动: docker compose -f docker-compose.https.yml up -d
#
# ============================================================

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 基础配置
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# 域名或IP地址
# 用于 SSL 证书生成和访问地址配置
DOMAIN=192.168.123.9

# 数据库密码
# 生产环境请使用强密码
POSTGRES_PASSWORD=your_secure_password_here

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 管理员账号配置
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# 管理员用户名
ADMIN_USERNAME=admin

# 管理员密码（首次部署时设置，后续可在管理后台修改）
# 要求：至少 8 个字符，包含小写字母和数字
ADMIN_PASSWORD=Admin@123456

# 管理员邮箱
ADMIN_EMAIL=admin@example.com

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 端口配置（可选）
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Identity Server HTTPS 端口（默认: 9443）
IDENTITY_PORT=9443

# Admin Portal HTTPS 端口（默认: 9444）
ADMIN_PORT=9444

# HTTP 端口，自动重定向到 HTTPS（默认: 9080）
HTTP_PORT=9080

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# OIDC 客户端配置（重要！）
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Admin Portal 回调地址（OIDC 登录成功后的跳转地址）
# 支持多个地址，用逗号分隔
# 注意: 必须与实际访问端口一致（使用上面配置的 ADMIN_PORT）
# 例如: https://admin.company.com/callback,https://192.168.1.100:8443/callback
ADMIN_REDIRECT_URIS=https://192.168.123.9:9444/callback

# Admin Portal 登出地址（OIDC 登出后的跳转地址）
# 支持多个地址，用逗号分隔
# 注意: 必须与实际访问端口一致（使用上面配置的 ADMIN_PORT）
# 例如: https://admin.company.com,https://192.168.1.100:8443
ADMIN_LOGOUT_URIS=https://192.168.123.9:9444

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 常见部署场景示例
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# 场景 1: 开发环境（本地访问，默认端口）
# DOMAIN=localhost
# IDENTITY_PORT=9443
# ADMIN_PORT=9444
# ADMIN_REDIRECT_URIS=https://localhost:9444/callback
# ADMIN_LOGOUT_URIS=https://localhost:9444

# 场景 2: 内网环境（IP 访问，自定义端口）
# DOMAIN=192.168.1.100
# IDENTITY_PORT=8443
# ADMIN_PORT=8444
# ADMIN_REDIRECT_URIS=https://192.168.1.100:8444/callback
# ADMIN_LOGOUT_URIS=https://192.168.1.100:8444

# 场景 3: 生产环境（域名访问，使用反向代理，默认 443 端口）
# DOMAIN=sso.company.com
# IDENTITY_PORT=443
# ADMIN_PORT=443
# ADMIN_REDIRECT_URIS=https://admin.company.com/callback
# ADMIN_LOGOUT_URIS=https://admin.company.com

# 场景 4: 多地址访问（支持多个入口）
# DOMAIN=sso.company.com
# IDENTITY_PORT=9443
# ADMIN_PORT=9444
# ADMIN_REDIRECT_URIS=https://admin.company.com/callback,https://192.168.1.100:9444/callback,https://10.0.0.50:8443/callback
# ADMIN_LOGOUT_URIS=https://admin.company.com,https://192.168.1.100:9444,https://10.0.0.50:8443

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 注意事项
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# 1. ADMIN_REDIRECT_URIS 必须以 /callback 结尾
# 2. 所有地址必须使用 https://（除非开发环境）
# 3. 端口号必须与实际访问端口一致
#    - 如果自定义了 ADMIN_PORT，回调地址中的端口也要相应修改
#    - 如果使用反向代理（如 nginx）暴露标准端口（443），则回调地址不需要端口号
# 4. 修改配置后需要重启 Identity 服务才能生效:
#    docker compose -f docker-compose.https.yml restart identity
# 5. 如使用反向代理，请确保代理正确转发了所有请求头
# 6. 端口范围建议: 1024-65535（避免使用特权端口 0-1023，除非以 root 运行）

