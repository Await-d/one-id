# 安全设计与合规

## 1. 威胁建模（STRIDE）与缓解
- **Spoofing**：强制 PKCE、MFA、WebAuthn、邮箱/手机号验证；
- **Tampering**：JWT 签名、JWK 轮换、密钥托管；
- **Repudiation**：全链路审计日志、签名与时间戳；
- **Information Disclosure**：最小化 Claim、加密传输、日志脱敏；
- **DoS**：速率限制、验证码（按需）、IP 黑白；
- **Elevation of Privilege**：最小权限、分级管理、审批流与变更审计。

## 2. 密钥与证书
- 生产禁用开发证书；采用 HSM/KMS（如 Vault / Key Vault）；
- kid 版本化，**灰度轮换**（旧新并存一段时间）。

## 3. 账号安全
- 密码策略（长度、复杂度、检查常见弱口令）；
- 登录保护（防撞库、IP/设备异常告警）；
- MFA（TOTP/WebAuthn）与恢复码；
- 账号冻结与解锁流程。

## 4. 令牌安全
- Access Token 短期；Refresh Token 轮换与绑定（Client/设备/Session）；
- 绑定地理与设备指纹（可选）；
- 撤销与内省机制。

## 5. 隐私与合规
- 数据最小化、目的限定、可导出/删除；
- 明示同意与撤回；
- 数据跨境（必要时本地化存储）。

## 6. 安全测试清单
- OWASP Top 10/ASVS；
- 登录/授权流红队演练；
- 依赖漏洞扫描与补丁管理。

