# 使用预编译文件的 Identity Dockerfile（无需网络）
FROM mcr.microsoft.com/dotnet/aspnet:9.0

# 安装 curl 用于健康检查
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

WORKDIR /app
EXPOSE 80

# 复制预编译的后端文件
COPY backend/publish/identity/ .

# 复制前端文件
COPY frontend/login/dist/ ./wwwroot/
COPY frontend/admin/dist/ ./wwwroot/admin/

ENTRYPOINT ["dotnet", "OneID.Identity.dll"]

